{{ define "dashboard.html" }}
{{ template "base.html" . }}
{{ end }}
{{ define "content" }}
<div class="flex h-screen bg-gray-100">
    <aside class="w-64 bg-white shadow-md p-6 flex flex-col">
        <h2 class="text-2xl font-bold text-blue-600">GoChat</h2>
        <nav class="mt-6 space-y-4">
            <a href="#" class="flex items-center space-x-3 text-gray-700 hover:text-blue-500">
                <span class="text-lg">ğŸ </span>
                <span>Home</span>
            </a>
            <a href="#" class="flex items-center space-x-3 text-gray-700 hover:text-blue-500">
                <span class="text-lg">ğŸ’¬</span>
                <span>Chats</span>
            </a>
            <a href="#" class="flex items-center space-x-3 text-gray-700 hover:text-blue-500">
                <span class="text-lg">ğŸ‘¥</span>
                <span>Friends</span>
            </a>
            <a href="#" class="flex items-center space-x-3 text-gray-700 hover:text-blue-500">
                <span class="text-lg">ğŸ””</span>
                <span>Notifications</span>
            </a>
            <a href="#" class="flex items-center space-x-3 text-gray-700 hover:text-blue-500">
                <span class="text-lg">âš™ï¸</span>
                <span>Settings</span>
            </a>
        </nav>
    </aside>

    <main class="flex-1 p-6">
        
        <div class="flex justify-between items-center bg-white p-4 shadow-md rounded-md">
            <h2 class="text-2xl font-semibold">Dashboard</h2>
            <div class="flex items-center space-x-4">
                <input type="text" placeholder="Search..." class="px-4 py-2 rounded-lg border border-gray-300">
                <button class="bg-blue-600 text-white px-4 py-2 rounded-lg">New Post</button>
            </div>
        </div>

        <!-- Feed  -->
        <div class="mt-6 space-y-6">
            <div class="bg-white p-4 rounded-lg shadow-md">
                <h3 class="text-lg font-bold">Your latest post</h3>
                <p class="text-gray-600 mt-2">"Exploring the world of Go and WebSockets! ğŸš€"</p>
                <div class="flex justify-between items-center mt-4 text-gray-500 text-sm">
                    <span>ğŸ’™ 120 Likes</span>
                    <span>ğŸ’¬ 30 Comments</span>
                </div>
            </div>

            <div class="bg-white p-4 rounded-lg shadow-md">
                <h3 class="text-lg font-bold">Recent Chat</h3>
                <p class="text-gray-600 mt-2">Alex: "Hey, have you checked out GoChat?"</p>
                <div class="flex justify-between items-center mt-4 text-gray-500 text-sm">
                    <span>â³ 2 mins ago</span>
                    <span class="text-blue-500">Reply</span>
                </div>
            </div>
        </div>
    </main>

    <!-- Right Sidebar -->
    <aside class="w-80 bg-white shadow-md p-6 hidden md:block">
        <h3 class="text-xl font-semibold">Active Friends</h3>
        <ul class="mt-4 space-y-3">
            <li class="flex items-center space-x-3">
                <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                <span>Emily</span>
            </li>
            <li class="flex items-center space-x-3">
                <span class="w-3 h-3 bg-green-500 rounded-full"></span>
                <span>Michael</span>
            </li>
        </ul>
        <h3 class="text-xl font-semibold mt-6">Friend Suggestions</h3>
        <div class="mt-4 space-y-3">
            <div class="flex justify-between items-center">
                <span>David</span>
                <button class="bg-blue-600 text-white px-3 py-1 rounded-md">Add</button>
            </div>
            <div class="flex justify-between items-center">
                <span>Sarah</span>
                <button class="bg-blue-600 text-white px-3 py-1 rounded-md">Add</button>
            </div>
        </div>
    </aside>
</div>
<script>
    document.addEventListener("DOMContentLoaded", async () => {
  const token = localStorage.getItem("token");

  if (!token) {
    window.location.href = "/login"; // Redirect to login if no token
    return;
  }

  try {
    const response = await fetch("/dashboard", {
      method: "GET",
      headers: {
        "Authorization": `Bearer ${token}`
      },
      credentials: "include"
    });

    if (!response.ok) {
      throw new Error("Unauthorized");
    }

    const data = await response.text();
    document.body.innerHTML = data; // Load dashboard content
  } catch (error) {
    console.error("Dashboard error:", error);
    localStorage.removeItem("token"); // Clear invalid token
    window.location.href = "/login"; // Redirect to login
  }
});

</script>
{{ end }}
